<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="The Marko programming language"><title>File-based Routing | Marko</title><link rel=icon sizes=32x32 href=/fav.png><link rel=icon type=image/svg+xml href=/fav.svg><link rel=preconnect href=https://GB0QQV5RQM-dsn.algolia.net crossorigin><script async type="module" crossorigin src="/assets/docs.marko-run.file-based-routing-UoxGPWaK.js"></script><link rel="modulepreload" crossorigin href="/assets/_BWPwbTm8.js"><link rel="modulepreload" crossorigin href="/assets/_D8hc6j_b.js"><link rel="modulepreload" crossorigin href="/assets/_TDlXLSMR.js"><link rel="stylesheet" crossorigin href="/assets/_layout-BcD9Kuto.css"><link rel="stylesheet" crossorigin href="/assets/_layout-hmI-Y7H7.css"><link rel="stylesheet" crossorigin href="/assets/app-code-block-DzvS1Xn3.css"></head><body><div id=root><header id=header><a title=Home href="/" id=_cZ><picture><source srcset=/logo.svg#dark media=(prefers-color-scheme:dark)><img alt="Marko Logo" src=/logo.svg></picture></a><div class=_cX><a href=/docs>Docs</a><a href=/playground>Playground</a><a href=https://github.com/marko-js/marko>GitHub</a></div><button aria-pressed=false aria-label="Show menu" id=_cY></button><!--M_*6 2--><div id=_c0><button disabled aria-hidden=true></button></div><!--M_*6 3--></header><main><script>document.documentElement.classList.toggle("concise-mode",localStorage.getItem("concise-mode")==='true');</script><script>document.documentElement.classList.toggle("ts-mode",localStorage.getItem("ts-mode")==='true');</script><div class=_de id=site-menu><nav class=_df id=_dg><ul><li><strong>Introduction</strong><ul><li><a href=/docs/introduction/getting-started>Getting Started</a></li><li><a href=/docs/introduction/welcome-to-marko>Welcome to Marko!</a></li><li><a href=/docs/introduction/installation>Installation</a></li><li><a href=/docs/introduction/why-marko>Why Marko?</a></li><li><a href=/docs/introduction/integrations>Integrations</a></li></ul></li><li><strong>Tutorials</strong><ul><li><a href=/docs/tutorial/fundamentals>Fundamentals</a></li><li><a href=/docs/tutorial/components-and-reactivity>Components and Reactivity</a></li></ul></li><li><strong>Guides</strong><ul><li><a href=/docs/guide/styling>Styling</a></li></ul></li><li><strong>Explanation</strong><ul><li><a href=/docs/explanation/streaming>Streaming</a></li><li><a href=/docs/explanation/targeted-compilation>Targeted Compilation</a></li><li><a href=/docs/explanation/fine-grained-bundling>Fine-Grained Bundling</a></li><li><a href=/docs/explanation/separation-of-concerns>Separation of Concerns</a></li><li><a href=/docs/explanation/controllable-components>Controllable Components</a></li><li><a href=/docs/explanation/nested-reactivity>Nested Reactivity</a></li><li><a href=/docs/explanation/immutable-state>Immutable State</a></li><li><a href=/docs/explanation/serializable-state>Serializable State</a></li></ul></li><li><strong>Reference</strong><ul><li><a href=/docs/reference/language>Language</a></li><li><a href=/docs/reference/custom-tag>Custom Tags</a></li><li><a href=/docs/reference/reactivity>Reactivity</a></li><li><a href=/docs/reference/core-tag>Core Tags</a></li><li><a href=/docs/reference/native-tag>Native Tags</a></li><li><a href=/docs/reference/concise-syntax>Concise Syntax</a></li><li><a href=/docs/reference/template>Template API</a></li><li><a href=/docs/reference/typescript>TypeScript</a></li></ul></li><li><strong>Marko Run</strong><ul><li><a href=/docs/marko-run/getting-started>Getting Started</a></li><li><a href=/docs/marko-run/file-based-routing aria-current=true>File-based Routing</a></li><li><a href=/docs/marko-run/typescript>TypeScript</a></li></ul></li></ul></nav><div id=_di><label class=_dj>Version&nbsp;<select><option value selected>6.x</option><option value=https://v5.markojs.com/docs/getting-started>5.x</option><option value="http://marko-v4.github.io/docs/">4.x</option><option value="http://v3.markojs.com/docs/">3.x</option><option value="http://marko-v2.github.io/docs/">2.x</option></select><!--M_*7 37--></label><label class=_n><span>HTML<!--M_*66 1--></span><span class=_m><input type=checkbox aria-label="Toggle Concise mode"><!--M_*66 3--><svg viewBox="0 0 576 512"><path d="M384 128c70.7 0 128 57.3 128 128S454.7 384 384 384l-192 0c-70.7 0-128-57.3-128-128s57.3-128 128-128l192 0zM576 256c0-106-86-192-192-192L192 64C86 64 0 150 0 256S86 448 192 448l192 0c106 0 192-86 192-192zM192 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!--M_*67 0--></span><span>Concise<!--M_*66 5--></span></label><label class=_n><span>JS<!--M_*69 1--></span><span class=_m><input type=checkbox aria-label="Toggle TS mode"><!--M_*69 3--><svg viewBox="0 0 576 512"><path d="M384 128c70.7 0 128 57.3 128 128S454.7 384 384 384l-192 0c-70.7 0-128-57.3-128-128s57.3-128 128-128l192 0zM576 256c0-106-86-192-192-192L192 64C86 64 0 150 0 256S86 448 192 448l192 0c106 0 192-86 192-192zM192 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!--M_*70 0--></span><span>TS<!--M_*69 5--></span></label></div></div><article id=_dl><h1 id=file-based-routing>File-based Routing</h1><section id=routes-directory><h2><a href=#routes-directory>Routes Directory</a></h2><p>The plugin looks for route files in the configured <strong>routes directory</strong>. By default, this is set to <code>./src/routes</code> relative to the Vite config file. This directory contains all the routing logic for the application.</p><p>Here&#39;s how to configure a different routes directory:</p><div class=code-block><div class=filename>vite.config.ts</div><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_0">import</span><span class="s_1"> { </span><span class="s_2">defineConfig</span><span class="s_1"> } </span><span class="s_0">from</span><span class="s_3"> "vite"</span><span class="s_1">;</span></span>
<span class="line"><span class="s_0">import</span><span class="s_2"> marko</span><span class="s_0"> from</span><span class="s_3"> "@marko/run/vite"</span><span class="s_1">;</span></span>
<span class="line"></span>
<span class="line"><span class="s_0">export</span><span class="s_0"> default</span><span class="s_4"> defineConfig</span><span class="s_1">({</span></span>
<span class="line"><span class="s_1">  plugins: [</span></span>
<span class="line"><span class="s_4">    marko</span><span class="s_1">({</span></span>
<span class="line"><span class="s_1">      routesDir: </span><span class="s_3">"src/pages"</span><span class="s_1">, </span><span class="s_5">// Use `./src/pages` (relative to this file) as the routes directory</span></span>
<span class="line"><span class="s_1">    }),</span></span>
<span class="line"><span class="s_1">  ],</span></span>
<span class="line"><span class="s_1">});</span></span></code></pre></div><style>.s_0{--shiki-light:#D91880;--shiki-dark:#FF4185}.s_1{--shiki-light:#202124;--shiki-dark:#FFF}.s_2{--shiki-light:#202124;--shiki-dark:#FFFFFF}.s_3{--shiki-light:#8A720A;--shiki-dark:#FFF066}.s_4{--shiki-light:#1D8649;--shiki-dark:#7FFF00}.s_5{--shiki-light:#73738C;--shiki-dark:#8F8F9E}.s_6{--shiki-light:#202124;--shiki-dark:#FFF;--shiki-light-bg:#00000000;--shiki-dark-bg:#00000000}</style></section><section id=routable-files><h2><a href=#routable-files>Routable Files</a></h2><p>The router only recognizes certain filenames, all prefixed with <code>+</code>. The following filenames will be discovered in any directory inside your applicationâ€™s <a href=#routes-directory>routes directory</a>.</p><section id=pagemarko><h3><a href=#pagemarko><code>+page.marko</code></a></h3><p>These files establish a route at the current directory path which will be served for <code>GET</code> requests with the HTML content of the page. Only one page may exist for any served path.</p></section><section id=layoutmarko><h3><a href=#layoutmarko><code>+layout.marko</code></a></h3><p>These files provide a <strong>layout component</strong>, which will wrap all nested layouts and pages. Information is obtained from <a href=../reference/language#global><code>$global</code></a> and <code>input</code> Layouts are like any other Marko component, with no extra constraints. Each layout receives the request, path params, URL, and route metadata as input, as well as a <code>content</code> which refers to the nested page that is being rendered.</p><div class=code-block><div class=html><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_5">/* +layout.marko */</span></span>
<span class="line"></span>
<span class="line"><span class="s_1">&#x3C;</span><span class="s_0">main</span><span class="s_1">></span></span>
<span class="line"><span class="s_1">  &#x3C;</span><span class="s_0">h1</span><span class="s_1">>My Products&#x3C;/</span><span class="s_0">h1</span><span class="s_1">></span></span>
<span class="line"></span>
<span class="line"><span class="s_1">  &#x3C;</span><span class="s_7">${</span><span class="s_2">input</span><span class="s_1">.</span><span class="s_2">content</span><span class="s_7">}</span><span class="s_1">/></span></span>
<span class="line"><span class="s_7">  ${</span><span class="s_3">" "</span><span class="s_7">}</span></span>
<span class="line"><span class="s_5">  // render the page or layout here</span></span>
<span class="line"><span class="s_1">&#x3C;/</span><span class="s_0">main</span><span class="s_1">></span></span></code></pre></div><div class=html-ts><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_5">/* +layout.marko */</span></span>
<span class="line"><span class="s_0">export</span><span class="s_8"> interface</span><span class="s_1"> Input {</span></span>
<span class="line"><span class="s_2">  content</span><span class="s_0">:</span><span class="s_1"> Marko.Body;</span></span>
<span class="line"><span class="s_1">}</span></span>
<span class="line"></span>
<span class="line"><span class="s_1">&#x3C;</span><span class="s_0">main</span><span class="s_1">></span></span>
<span class="line"><span class="s_1">  &#x3C;</span><span class="s_0">h1</span><span class="s_1">>My Products&#x3C;/</span><span class="s_0">h1</span><span class="s_1">></span></span>
<span class="line"></span>
<span class="line"><span class="s_1">  &#x3C;</span><span class="s_7">${</span><span class="s_2">input</span><span class="s_1">.</span><span class="s_2">content</span><span class="s_7">}</span><span class="s_1">/></span></span>
<span class="line"><span class="s_7">  ${</span><span class="s_3">" "</span><span class="s_7">}</span></span>
<span class="line"><span class="s_5">  // render the page or layout here</span></span>
<span class="line"><span class="s_1">&#x3C;/</span><span class="s_0">main</span><span class="s_1">></span></span></code></pre></div><div class=concise><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_5">/* +layout.marko */</span></span>
<span class="line"></span>
<span class="line"><span class="s_0">main</span></span>
<span class="line"><span class="s_0">  h1</span><span class="s_1"> -- My Products</span></span>
<span class="line"></span>
<span class="line"><span class="s_7">  ${</span><span class="s_2">input</span><span class="s_1">.</span><span class="s_2">content</span><span class="s_7">}</span></span>
<span class="line"><span class="s_1">  -- </span><span class="s_7">${</span><span class="s_3">" "</span><span class="s_7">}</span></span>
<span class="line"><span class="s_5">  // render the page or layout here</span></span></code></pre></div><div class=concise-ts><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_5">/* +layout.marko */</span></span>
<span class="line"><span class="s_0">export</span><span class="s_8"> interface</span><span class="s_1"> Input {</span></span>
<span class="line"><span class="s_2">  content</span><span class="s_0">:</span><span class="s_1"> Marko.Body;</span></span>
<span class="line"><span class="s_1">}</span></span>
<span class="line"></span>
<span class="line"><span class="s_0">main</span></span>
<span class="line"><span class="s_0">  h1</span><span class="s_1"> -- My Products</span></span>
<span class="line"></span>
<span class="line"><span class="s_7">  ${</span><span class="s_2">input</span><span class="s_1">.</span><span class="s_2">content</span><span class="s_7">}</span></span>
<span class="line"><span class="s_1">  -- </span><span class="s_7">${</span><span class="s_3">" "</span><span class="s_7">}</span></span>
<span class="line"><span class="s_5">  // render the page or layout here</span></span></code></pre></div></div><style>.s_7{--shiki-light:#0D7BBF;--shiki-dark:#66D9EF}.s_8{--shiki-light:#0D7BBF;--shiki-light-font-style:italic;--shiki-dark:#5BD7FF;--shiki-dark-font-style:italic}</style></section><section id=handler><h3><a href=#handler><code>+handler.*</code></a></h3><p>These files establish a route at the current directory path which can handle requests for <code>GET</code>, <code>POST</code>, <code>PUT</code>, and <code>DELETE</code> HTTP methods. </p><p>Typically, these will be <code>.js</code> or <code>.ts</code> files depending on your project. Like pages, only one handler for each method may exist for any served path. A handler should export functions</p><ul><li><p>Valid exports are functions named <code>GET</code>, <code>POST</code>, <code>PUT</code>, or <code>DELETE</code>.</p></li><li><p>Exports can be one of the following</p><ul><li>Handler function (see below)</li><li>Array of handler functions - will be composed by calling them in order</li><li>Promise that resolves to a handler function or array of handler functions</li></ul></li><li><p>Handler functions are synchronous or asynchronous functions that</p><ul><li><p>Receives a <code>context</code> and <code>next</code> argument,</p><ul><li>The <code>context</code> argument contains the WHATWG request object, path parameters, URL, and route metadata.</li><li>The <code>next</code> argument will call the page for <code>GET</code> requests where applicable or return a <code>204</code> response.</li></ul></li><li><p>Return a WHATWG response, throw a WHATWG response, and return undefined. If the function returns undefined the <code>next</code> argument with be automatically called and used as the response.</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_5">/* +handler.ts */</span></span>
<span class="line"><span class="s_0">export</span><span class="s_8"> function</span><span class="s_4"> POST</span><span class="s_1">(</span><span class="s_9">context</span><span class="s_1">, </span><span class="s_9">next</span><span class="s_1">) {</span></span>
<span class="line"><span class="s_8">  const</span><span class="s_1"> { </span><span class="s_2">request</span><span class="s_1">, </span><span class="s_2">params</span><span class="s_1">, </span><span class="s_2">url</span><span class="s_1">, </span><span class="s_2">meta</span><span class="s_1"> } </span><span class="s_2">=</span><span class="s_2"> context</span><span class="s_1">;</span></span>
<span class="line"><span class="s_0">  return</span><span class="s_0"> new</span><span class="s_4"> Response</span><span class="s_1">(</span><span class="s_3">"Successfully updated"</span><span class="s_1">, { status: </span><span class="s_a">200</span><span class="s_1"> });</span></span>
<span class="line"><span class="s_1">}</span></span>
<span class="line"></span>
<span class="line"><span class="s_0">export</span><span class="s_b"> async</span><span class="s_8"> function</span><span class="s_4"> GET</span><span class="s_1">(</span><span class="s_9">context</span><span class="s_1">, </span><span class="s_9">next</span><span class="s_1">) {</span></span>
<span class="line"><span class="s_5">  // do something before calling `next`</span></span>
<span class="line"><span class="s_8">  const</span><span class="s_2"> response</span><span class="s_2"> =</span><span class="s_0"> await</span><span class="s_4"> next</span><span class="s_1">();</span></span>
<span class="line"><span class="s_0">  return</span><span class="s_2"> response</span><span class="s_1">;</span></span>
<span class="line"><span class="s_1">}</span></span></code></pre></div><style>.s_9{--shiki-light:#B05C1C;--shiki-light-font-style:italic;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic}.s_a{--shiki-light:#7C4DFF;--shiki-dark:#AE81FF}.s_b{--shiki-light:#D91880;--shiki-dark:#FF4D8F}</style></li></ul></li></ul></section><section id=middleware><h3><a href=#middleware><code>+middleware.*</code></a></h3><p>These files are like layouts, but for handlers. Middleware files are called before handlers and let you perform arbitrary work before and after.</p><callout role=note aria-labelledby=callout-cot-0 class=admonition-note><cot id=callout-cot-0>Note</cot><p>Unlike handlers, middleware run for all HTTP methods.</p></callout><ul><li><p>Expects a <code>default</code> export that can be one of the following</p><ul><li>Handler function (see below)</li><li>Array of handler functions - will be composed by calling them in order</li><li>Promise that resolves to a handler function or array of handler functions</li></ul></li><li><p>Handler functions are synchronous or asynchronous functions that</p><ul><li><p>Receives a <code>context</code> and <code>next</code> argument,</p><ul><li>The <code>context</code> argument contains the WHATWG request object, path parameters, URL, and route metadata.</li><li>The <code>next</code> argument will call the page for <code>GET</code> requests where applicable or return a <code>204</code> response.</li></ul></li><li><p>Return a WHATWG response, throw a WHATWG response, and return undefined. If the function returns undefined the <code>next</code> argument with be automatically called and used as the response.</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span class="s_5">/* +middleware.ts */</span></span>
<span class="line"><span class="s_0">export</span><span class="s_0"> default</span><span class="s_b"> async</span><span class="s_8"> function</span><span class="s_1"> (</span><span class="s_9">context</span><span class="s_1">, </span><span class="s_9">next</span><span class="s_1">) {</span></span>
<span class="line"><span class="s_8">  const</span><span class="s_2"> requestName</span><span class="s_2"> =</span><span class="s_3"> `</span><span class="s_7">${</span><span class="s_2">context</span><span class="s_3">.</span><span class="s_2">request</span><span class="s_3">.</span><span class="s_2">method</span><span class="s_7">}</span><span class="s_7"> ${</span><span class="s_2">context</span><span class="s_3">.</span><span class="s_2">url</span><span class="s_3">.</span><span class="s_2">href</span><span class="s_7">}</span><span class="s_3">`</span><span class="s_1">;</span></span>
<span class="line"><span class="s_8">  let</span><span class="s_2"> success</span><span class="s_2"> =</span><span class="s_a"> true</span><span class="s_1">;</span></span>
<span class="line"><span class="s_2">  console</span><span class="s_1">.</span><span class="s_4">log</span><span class="s_1">(</span><span class="s_3">`</span><span class="s_7">${</span><span class="s_2">requestName</span><span class="s_7">}</span><span class="s_3"> request started`</span><span class="s_1">);</span></span>
<span class="line"><span class="s_0">  try</span><span class="s_1"> {</span></span>
<span class="line"><span class="s_0">    return</span><span class="s_0"> await</span><span class="s_4"> next</span><span class="s_1">(); </span><span class="s_5">// Wait for subsequent middleware, handler, and page</span></span>
<span class="line"><span class="s_1">  } </span><span class="s_0">catch</span><span class="s_1"> (</span><span class="s_2">err</span><span class="s_1">) {</span></span>
<span class="line"><span class="s_2">    success</span><span class="s_2"> =</span><span class="s_a"> false</span><span class="s_1">;</span></span>
<span class="line"><span class="s_0">    throw</span><span class="s_2"> err</span><span class="s_1">;</span></span>
<span class="line"><span class="s_1">  } </span><span class="s_0">finally</span><span class="s_1"> {</span></span>
<span class="line"><span class="s_2">    console</span><span class="s_1">.</span><span class="s_4">log</span><span class="s_1">(</span></span>
<span class="line"><span class="s_3">      `</span><span class="s_7">${</span><span class="s_2">requestName</span><span class="s_7">}</span><span class="s_3"> completed </span><span class="s_7">${</span><span class="s_2">success</span><span class="s_0"> ?</span><span class="s_3"> "successfully"</span><span class="s_0"> :</span><span class="s_3"> "with errors"</span><span class="s_7">}</span><span class="s_3">`</span><span class="s_1">,</span></span>
<span class="line"><span class="s_1">    );</span></span>
<span class="line"><span class="s_1">  }</span></span>
<span class="line"><span class="s_1">}</span></span></code></pre></div></li></ul></li></ul></section><section id=meta><h3><a href=#meta><code>+meta.*</code></a></h3><p>These files represent static metadata to attach to the route. This metadata will be automatically provided on the route <code>context</code> when invoking a route.</p></section></section><section id=special-files><h2><a href=#special-files>Special Files</a></h2><p>In addition to the files above which can be defined in any directory under the <a href=#routes-directory>routes directory</a>, some special files can only be defined at its top level. </p><p>These special pages are subject to a root layout file (<code>pages/+layout.marko</code> in the default configuration).</p><section id=404marko><h3><a href=#404marko><code>+404.marko</code></a></h3><p>This special page responds to any request where:</p><ul><li>The <code>Accept</code> request header includes <code>text/html</code></li><li><em>And</em> no other handler or page rendered the request</li></ul><p>Responses with this page will have a <code>404</code> status code.</p></section><section id=500marko><h3><a href=#500marko><code>+500.marko</code></a></h3><p>This special page responds to any request where:</p><ul><li>The <code>Accept</code> request header includes <code>text/html</code></li><li><em>And</em> an uncaught error occurs while serving the request</li></ul><p>Responses with this page will have a <code>500</code> status code.</p></section></section><section id=execution-order><h2><a href=#execution-order>Execution Order</a></h2><p>Given the following routes directory structure</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  about/</span></span>
<span class="line"><span>    +handler.js</span></span>
<span class="line"><span>    +layout.marko</span></span>
<span class="line"><span>    +middleware.js</span></span>
<span class="line"><span>    +page.marko</span></span>
<span class="line"><span>  +layout.marko</span></span>
<span class="line"><span>  +middleware.js</span></span>
<span class="line"><span>  +page.marko</span></span></code></pre></div><p>When the path <code>/about</code> is requested, the routable files execute in the following order:</p><ol><li>Middlewares from root-most to leaf-most</li><li>Handler</li><li>Layouts from root-most to leaf-most</li><li>Page</li></ol></section><section id=path-structure><h2><a href=#path-structure>Path Structure</a></h2><p>Within the <a href=#routes-directory>routes directory</a>, the directory structure determines the path from which the route is served. There are four types of directory names: <strong>static</strong>, <strong>pathless</strong>, <strong>dynamic</strong>, and <strong>catch-all</strong>.</p><ol><li><p><strong>Static directories</strong> - The most common type, and the default behavior. Each static directory contributes its name as a segment in the route&#39;s served path, like a traditional fileserver. Unless a directory name matches the requirements for one of the below types, it is seen as a static directory.</p><p>Examples:</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>/foo</span></span>
<span class="line"><span>/users</span></span>
<span class="line"><span>/projects</span></span></code></pre></div></li><li><p><strong>Pathless directories</strong> - These directories do <strong>not</strong> contribute their name to the route&#39;s served path. Directory names that start with an underscore (<code>_</code>) will be ignored when parsing the route.</p><p>Examples:</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>/_users</span></span>
<span class="line"><span>/_public</span></span></code></pre></div></li><li><p><strong>Dynamic directories</strong> - These directories introduce a dynamic parameter to the route&#39;s served path and will match any value at that segment. Any directory name that starts with a single dollar sign (<code>$</code>) will be a dynamic directory, and the remaining directory name will be the parameter at runtime. If the directory name is exactly <code>$</code>, the parameter will not be captured but it will be matched.</p><p>Examples:</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>/$id</span></span>
<span class="line"><span>  /$name</span></span>
<span class="line"><span>/$</span></span></code></pre></div></li><li><p><strong>Catch-all directories</strong> - These directories are similar to dynamic directories and introduce a dynamic parameter, but instead of matching a single path segment, they match to the end of the path. Any directory that starts with two dollar signs (<code>$$</code>) will be a catch-all directory, and the remaining directory name will be the parameter at runtime. In the case of a directory named <code>$$</code>, the parameter name will not be captured but it will match. Catch-all directories can be used to make <code>404</code> Not Found routes at any level, including the root.</p><p>Because catch-all directories match any path segment and consume the rest of the path, you cannot nest route files in them and no further directories will be traversed.</p><p>Examples:</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>/$$all</span></span>
<span class="line"><span>  /$$rest</span></span>
<span class="line"><span>/$$</span></span></code></pre></div></li></ol></section><section id=flat-routes><h2><a href=#flat-routes>Flat Routes</a></h2><p>Flat routes let you define paths without needing additional directories. Instead the directory structure can be defined either in the file or directory name. This allows you to decouple your routes from your directory structure or co-locate them as needed. To define a flat route, use periods (<code>.</code>) to delineate each path segment. This behaves exactly like creating a new directory and each segment will be parsed using the rules described above for static, dynamic and pathless routes.</p><p>Flat routes syntax can be used for both directories and routable files (eg. pages, handlers, middleware, etc.). For these files, anything proceeding the plus (<code>+</code>) will be treated as the flat route.</p><p>For example to define a page at <code>/projects/$projectId/members</code> with a root layout and a project layout:</p><p>Without flat routes you would have a file structure like:</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects/</span></span>
<span class="line"><span>    $projectId/</span></span>
<span class="line"><span>    $members/</span></span>
<span class="line"><span>      +page.marko</span></span>
<span class="line"><span>        +layout.marko</span></span>
<span class="line"><span>        +layout.marko</span></span></code></pre></div><p>With flat routes move the path defined by the directories into the files and separate with a period</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  +layout.marko</span></span>
<span class="line"><span>  projects+layout.marko</span></span>
<span class="line"><span>  projects.$projectId.members+page.marko</span></span></code></pre></div><p>Additionally, you can continue to organize files under directories to decrease duplication and use flat route syntax in the folder name</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects.$projectId/</span></span>
<span class="line"><span>  +layout.marko</span></span>
<span class="line"><span>  members+page.marko</span></span>
<span class="line"><span>  +layout.marko</span></span></code></pre></div><p>Finally, flat routes and routes defined with directories are all treated equally and merged together. For example this page will have layout</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects/</span></span>
<span class="line"><span>    $projectId/</span></span>
<span class="line"><span>      +layout.marko</span></span>
<span class="line"><span>  projects.$projectId+page.marko</span></span></code></pre></div></section><section id=multiple-paths-groups-and-optional-segments><h2><a href=#multiple-paths-groups-and-optional-segments>Multiple Paths, Groups and Optional Segments</a></h2><p>Along with describing multiple segments, flat route syntax supports defining routes that match more than one path and segments that are optional. To describe a route that matches multiple paths, use a comma (<code>,</code>) and define each route.</p><p>For example the following page matches <code>/projects/$projectId/members</code> and <code>/projects/$projectId/people</code></p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects.$projectId.members,projects.$projectId.people+page.marko</span></span></code></pre></div><p>This file name is a bit long so you might do something like this</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects.$projectId</span></span>
<span class="line"><span>  members,people+page.marko</span></span></code></pre></div><p>We can simplify this by introducing another concept: <strong>grouping</strong>. Groups allows you to define segments within a flat route that match multiple sub-paths by surrounding them with parentheses (<code>(</code> and <code>)</code>). For the example, this means you can do the following:</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects.$projectId.(members,people)+page.marko</span></span></code></pre></div><p>This is a simple example of grouping but you can nest groups and make them as complicated as you want.</p><p>The last concept is <strong>optionality</strong>. By introducing an empty segment or pathless segment along with another value you can make that segment optional. For example, If we want a page that matches <code>/projects</code> and <code>/projects/home</code>, you can create a flat route that optionally matches <code>home</code></p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects.(home,)+page.marko</span></span></code></pre></div><p>or</p><div class=code-block><pre class="shiki shiki-themes marko-light marko-dark s_6" tabindex="0"><code><span class="line"><span>routes/</span></span>
<span class="line"><span>  projects.(home,_pathless)+page.marko</span></span></code></pre></div><p>While both of these create a route which matches the paths, they have slightly different semantics. Using a pathless segment is the same as creating a pathless directory which allows you to isolate middleware and layouts. Using an empty segment is the same as defining a file at the current location.</p></section><hr><section id=_dm><h2 id=contributors><a href=#contributors>Contributors</a></h2><p>Helpful? You can thank these awesome people! You can also edit this doc if you see any issues or want to improve it.</p><script>(e=>(self[e]||(self[e]=(l,f=e+l,s=f.length,a={},d=[],t=document,n=t.createTreeWalker(t,129))=>t=self[e][l]={i:f,d:t,l:a,v:d,x(){},w(e,l,r){for(;e=n.nextNode();)t.x(l=(l=e.data)&&!l.indexOf(f)&&(a[r=l.slice(s+1)]=e,l[s]),r,e),l>"#"&&d.push(e)}}),self[e]))("M")("_");M._.r=[_=>(_.h=[{params:{},url:new URL("http://localhost/docs/marko-run/file-based-routing")},5,{4:!1},_.b={0:_.a={3:"concise-mode"},1:9,3:_.c={3:"ts-mode"},4:11,38:_.e={10:_.d={"aria-label":"Toggle Concise mode",checked:!1},f3:0},39:_.g={10:_.f={"aria-label":"Toggle TS mode",checked:!1},f3:0},40:!1,41:!1},_.a,1,_.c,55,_.e,{5:{},7:576,8:512},1,_.g,{5:{},7:576,8:512},48,{5:"routes-directory"},{5:"routable-files"},2,{5:"pagemarko"},{5:"layoutmarko"},{5:"handler"},{5:"middleware"},{5:"meta"},{5:"special-files"},2,{5:"404marko"},{5:"500marko"},{5:"execution-order"},{5:"path-structure"},{5:"flat-routes"},{5:"multiple-paths-groups-and-optional-segments"}],_.a.f=_._.e0(_.a),_.a.e=_._.o2(_.b),_.c.f=_._.e0(_.c),_.c.e=_._.o3(_.b),_.d.checkedChange=_.e.e3=_._.o0(_.b),_.f.checkedChange=_.g.e3=_._.o1(_.b),_.h),"h0",5,"n0",6,"n1",6,"e1",8,10,"c0",67,"q0",66,"c0",70,"q0",69,"o32",7,"o33",7,"o34",7];M._.w()</script><ul><li><a href=https://github.com/DylanPiercey><img src=https://avatars.githubusercontent.com/u/4985201?v=4 alt>DylanPiercey</a></li><li><a href=https://github.com/LuLaValva><img src=https://avatars.githubusercontent.com/u/26027232?v=4 alt>LuLaValva</a></li><li><a href=https://github.com/marko-js/website-next/blob/main/docs/marko-run/file-based-routing.md><div><svg viewBox="0 0 448 512"><path d="M256 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 160-160 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l160 0 0 160c0 17.7 14.3 32 32 32s32-14.3 32-32l0-160 160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-160 0 0-160z"></path></svg><!--M_*142 0--></div>You?</a></li></ul></section></article><div class=_de id=page-menu><nav aria-labelledby=sM_1 class=_df id=_dk><ul><li><strong id=sM_1>On this Page</strong></li><li><a href=#routes-directory>Routes Directory</a><!--M_*119 0--></li><li><a href=#routable-files>Routable Files</a><!--M_*120 0--><ul><li><a href=#pagemarko>+page.marko</a><!--M_*123 0--></li><li><a href=#layoutmarko>+layout.marko</a><!--M_*124 0--></li><li><a href=#handler>+handler.*</a><!--M_*125 0--></li><li><a href=#middleware>+middleware.*</a><!--M_*126 0--></li><li><a href=#meta>+meta.*</a><!--M_*127 0--></li></ul></li><li><a href=#special-files>Special Files</a><!--M_*128 0--><ul><li><a href=#404marko>+404.marko</a><!--M_*131 0--></li><li><a href=#500marko>+500.marko</a><!--M_*132 0--></li></ul></li><li><a href=#execution-order>Execution Order</a><!--M_*133 0--></li><li><a href=#path-structure>Path Structure</a><!--M_*134 0--></li><li><a href=#flat-routes>Flat Routes</a><!--M_*135 0--></li><li><a href=#multiple-paths-groups-and-optional-segments>Multiple Paths, Groups and Optional Segments</a><!--M_*136 0--></li></ul></nav></div></main></div><footer id=_a><a href="https://openjsf.org/" class=_b><img src=/assets/openjsf-u4IcyPV8.svg alt> <span><span class=_e>OpenJS&nbsp;</span><span class=_f>Foundation</span></span></a><div class=_g></div><a href=https://github.com/marko-js/marko/blob/main/LICENSE class=_d><img src=/assets/osi-BEF6Mbrt.svg alt> MIT&nbsp;License</a><div class=_g></div><a href=https://github.com/eBay class=_c><img src=/assets/ebay-CSr9mcj_.svg alt=eBay> open&nbsp;source</a></footer><script>M._.r.push(_=>(_.i=[5,{5:{},7:448,8:512}]),"c0",142,"j0",119,123,124,125,126,127,120,131,132,128,133,134,135,136);M._.w()</script></body></html>