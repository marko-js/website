<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="The Marko programming language"><title>Serializable State | Marko</title><link rel=icon sizes=32x32 href=/fav.png><link rel=icon type=image/svg+xml href=/fav.svg><link rel=preconnect href=https://GB0QQV5RQM-dsn.algolia.net crossorigin><script async type="module" crossorigin src="/assets/docs.explanation.serializable-state-O_tk2X1d.js"></script><link rel="modulepreload" crossorigin href="/assets/_C2fQw5uk.js"><link rel="modulepreload" crossorigin href="/assets/_DUjb9J-I.js"><link rel="modulepreload" crossorigin href="/assets/_DyXuNQ5I.js"><link rel="stylesheet" crossorigin href="/assets/_layout-D8udmJ1b.css"><link rel="stylesheet" crossorigin href="/assets/_layout-C-8xNbEW.css"><link rel="stylesheet" crossorigin href="/assets/app-code-block-DzvS1Xn3.css"></head><body><div id=root><header id=header><a title=Home href="/" id=_cW><picture><source srcset=/assets/logo.svg#dark media=(prefers-color-scheme:dark)><img alt="Marko Logo" src=/assets/logo.svg></picture></a><!--M_*5 a--><div class=_cU><a href=/docs>Docs</a><a href=/playground>Playground</a><a href=https://github.com/marko-js/marko>GitHub</a></div><button aria-pressed=false aria-label="Show menu" id=_cV></button><!--M_*5 c--><div id=_cX><button disabled aria-hidden=true></button></div><!--M_*5 d--></header><main><script>document.documentElement.classList.toggle("concise-mode",localStorage.getItem("concise-mode")==='true');</script><script>document.documentElement.classList.toggle("ts-mode",localStorage.getItem("ts-mode")==='true');</script><div class=_dj id=site-menu><nav class=_dk id=_dl><ul><li><strong>Introduction</strong><ul><li><a href=/docs/introduction/getting-started>Getting Started</a></li><li><a href=/docs/introduction/welcome-to-marko>Welcome to Marko!</a></li><li><a href=/docs/introduction/installation>Installation</a></li><li><a href=/docs/introduction/why-marko>Why Marko?</a></li><li><a href=/docs/introduction/integrations>Integrations</a></li></ul></li><li><strong>Tutorials</strong><ul><li><a href=/docs/tutorial/fundamentals>Fundamentals</a></li><li><a href=/docs/tutorial/components-and-reactivity>Components and Reactivity</a></li></ul></li><li><strong>Guides</strong><ul><li><a href=/docs/guide/styling>Styling</a></li><li><a href=/docs/guide/marko-5-interop>Marko 5 Interop</a></li></ul></li><li><strong>Explanation</strong><ul><li><a href=/docs/explanation/why-is-marko-fast>Why is Marko Fast?</a></li><li><a href=/docs/explanation/streaming>Streaming</a></li><li><a href=/docs/explanation/targeted-compilation>Targeted Compilation</a></li><li><a href=/docs/explanation/fine-grained-bundling>Fine-Grained Bundling</a></li><li><a href=/docs/explanation/separation-of-concerns>Separation of Concerns</a></li><li><a href=/docs/explanation/controllable-components>Controllable Components</a></li><li><a href=/docs/explanation/nested-reactivity>Nested Reactivity</a></li><li><a href=/docs/explanation/immutable-state>Immutable State</a></li><li><a href=/docs/explanation/serializable-state aria-current=true>Serializable State</a></li></ul></li><li><strong>Reference</strong><ul><li><a href=/docs/reference/language>Language</a></li><li><a href=/docs/reference/custom-tag>Custom Tags</a></li><li><a href=/docs/reference/reactivity>Reactivity</a></li><li><a href=/docs/reference/core-tag>Core Tags</a></li><li><a href=/docs/reference/native-tag>Native Tags</a></li><li><a href=/docs/reference/typescript>TypeScript</a></li><li><a href=/docs/reference/template>Template API</a></li><li><a href=/docs/reference/concise-syntax>Concise Syntax</a></li></ul></li><li><strong>Marko Run</strong><ul><li><a href=/docs/marko-run/getting-started>Getting Started</a></li><li><a href=/docs/marko-run/file-based-routing>File-based Routing</a></li><li><a href=/docs/marko-run/typescript>TypeScript</a></li></ul></li></ul></nav><!--M_*6 h--><div id=_dn><label class=_do>Version&nbsp;<select><option value selected>6.x</option><option value=https://v5.markojs.com/docs/getting-started>5.x</option><option value="http://marko-v4.github.io/docs/">4.x</option><option value="http://v3.markojs.com/docs/">3.x</option><option value="http://marko-v2.github.io/docs/">2.x</option></select><!--M_*6 ad--></label><label class=_R><span>HTML</span><span class=_Q><input type=checkbox aria-label="Toggle Concise mode"><!--M_*69 d--><svg viewBox="0 0 576 512"><path d="M384 128c70.7 0 128 57.3 128 128S454.7 384 384 384l-192 0c-70.7 0-128-57.3-128-128s57.3-128 128-128l192 0zM576 256c0-106-86-192-192-192L192 64C86 64 0 150 0 256S86 448 192 448l192 0c106 0 192-86 192-192zM192 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!--M_*70 a--></span><span>Concise</span></label><label class=_R><span>JS</span><span class=_Q><input type=checkbox aria-label="Toggle TS mode"><!--M_*72 d--><svg viewBox="0 0 576 512"><path d="M384 128c70.7 0 128 57.3 128 128S454.7 384 384 384l-192 0c-70.7 0-128-57.3-128-128s57.3-128 128-128l192 0zM576 256c0-106-86-192-192-192L192 64C86 64 0 150 0 256S86 448 192 448l192 0c106 0 192-86 192-192zM192 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!--M_*73 a--></span><span>TS</span></label></div></div><script>document.getElementById("_dl").scrollTop = +(sessionStorage.getItem("menu-scroll-position") || 0)</script><article id=_dC><h1 id=serializable-state>Serializable State</h1><p>Marko seamlessly picks up where the server left off when it comes to events, scripts and client side updates through state. In order to do this Marko will attempt to serialize as little data as possible from the server to the client.</p><p>Most standard data types can be serialized, including:</p><ul><li>Primitives: <code>null</code>, <code>boolean</code>, <code>number</code>, <code>string</code>, <code>bigint</code></li><li>Arrays and plain objects with serializable values</li><li>Dates</li><li>Map, Set</li><li>Typed arrays and ArrayBuffer/DataView</li><li>URL and URLSearchParams</li><li>Additional built-in JS and Browser objects<ul><li>For a complete list, see the <a href=https://github.com/marko-js/marko/blob/main/packages/runtime-tags/src/html/serializer.ts>serializer file</a> from source</li></ul></li></ul><p>... and many more.</p><section id=unserializable-data><h2><a href=#unserializable-data>Unserializable Data</a></h2><p>Some values cannot be serialized. When these values are encountered the Marko runtime will provide a helpful message to locate the relevant code.</p><p>Examples of unserializable data include:</p><ul><li>Closures (top level functions are fine!)</li><li>Functions that come from arbitrary javascript code or imports</li><li>Class instances (except built-ins explicitly supported by the runtime)</li><li>DOM nodes and elements</li></ul><callout role=note aria-labelledby=callout-cot-0 class=admonition-note><cot id=callout-cot-0>Note</cot><p>Most functions and closures <em>are</em> serializable.</p><div class=code-block><div class="html html-ts"><pre class="shiki shiki-themes marko-light marko-dark s_8" tabindex="0"><code><span class="line"><span class="s_0">&#x3C;</span><span class="s_1">let</span><span class="s_0">/</span><span class="s_2">handler=</span><span class="s_3">null</span><span class="s_0">></span></span>
<span class="line"><span class="s_0">&#x3C;</span><span class="s_1">const</span><span class="s_0">/</span><span class="s_2">onSecondClick</span><span class="s_0">() { </span></span>
<span class="line"><span class="s_4">  // serializable!</span></span>
<span class="line"><span class="s_0">}></span></span>
<span class="line"></span>
<span class="line"><span class="s_0">&#x3C;</span><span class="s_5">button</span><span class="s_6"> onClick</span><span class="s_0">() { </span><span class="s_7">handler</span><span class="s_0">?.(); </span><span class="s_2">handler</span><span class="s_2"> =</span><span class="s_2"> onSecondClick</span><span class="s_0"> }/></span></span></code></pre></div><div class="concise concise-ts"><pre class="shiki shiki-themes marko-light marko-dark s_8" tabindex="0"><code><span class="line"><span class="s_1">let</span><span class="s_0">/</span><span class="s_2">handler=</span><span class="s_3">null</span></span>
<span class="line"><span class="s_1">const</span><span class="s_0">/</span><span class="s_2">onSecondClick</span><span class="s_0">() { </span></span>
<span class="line"><span class="s_4">  // serializable!</span></span>
<span class="line"><span class="s_0">}</span></span>
<span class="line"></span>
<span class="line"><span class="s_5">button</span><span class="s_6"> onClick</span><span class="s_0">() { </span><span class="s_7">handler</span><span class="s_0">?.(); </span><span class="s_2">handler</span><span class="s_2"> =</span><span class="s_2"> onSecondClick</span><span class="s_0"> }</span></span></code></pre></div></div><style>.s_0{--shiki-light:#202124;--shiki-dark:#FFF}.s_1{--shiki-light:#0D7BBF;--shiki-dark:#66D9EF}.s_2{--shiki-light:#202124;--shiki-dark:#FFFFFF}.s_3{--shiki-light:#7C4DFF;--shiki-dark:#AE81FF}.s_4{--shiki-light:#73738C;--shiki-dark:#8F8F9E}.s_5{--shiki-light:#D91880;--shiki-dark:#FF4185}.s_6{--shiki-light:#0D7BBF;--shiki-light-font-style:italic;--shiki-dark:#66D9EF;--shiki-dark-font-style:italic}.s_7{--shiki-light:#1D8649;--shiki-dark:#7FFF00}.s_8{--shiki-light:#202124;--shiki-dark:#FFF;--shiki-light-bg:#00000000;--shiki-dark-bg:#00000000}</style></callout><div class=code-block><div class="html html-ts"><pre class="shiki shiki-themes marko-light marko-dark s_8" tabindex="0"><code><span class="line"><span class="s_4">// ❌ BAD: custom class instance in state</span></span>
<span class="line"><span class="s_0">&#x3C;</span><span class="s_1">let</span><span class="s_0">/</span><span class="s_2">state=</span><span class="s_5">new</span><span class="s_2"> Cart</span><span class="s_0">()></span></span>
<span class="line"><span class="s_4">// ❌ BAD: DOM nodes in state</span></span>
<span class="line"><span class="s_0">&#x3C;</span><span class="s_1">let</span><span class="s_0">/</span><span class="s_2">state=</span><span class="s_0">{ el: </span><span class="s_2">document</span><span class="s_0">.</span><span class="s_2">body</span><span class="s_0"> }></span></span></code></pre></div><div class="concise concise-ts"><pre class="shiki shiki-themes marko-light marko-dark s_8" tabindex="0"><code><span class="line"><span class="s_4">// ❌ BAD: custom class instance in state</span></span>
<span class="line"><span class="s_1">let</span><span class="s_0">/</span><span class="s_2">state=</span><span class="s_5">new</span><span class="s_2"> Cart</span><span class="s_0">()</span></span>
<span class="line"><span class="s_4">// ❌ BAD: DOM nodes in state</span></span>
<span class="line"><span class="s_1">let</span><span class="s_0">/</span><span class="s_2">state=</span><span class="s_0">{ el: </span><span class="s_2">document</span><span class="s_0">.</span><span class="s_2">body</span><span class="s_0"> }</span></span></code></pre></div></div></section><section id=further-reading><h2><a href=#further-reading>Further Reading</a></h2><ul><li><a href=./immutable-state>Immutable State</a></li><li><a href=../reference/reactivity>Reactivity</a></li><li><a href=./fine-grained-bundling>Fine-Grained Bundling</a></li><li><a href=./streaming>Streaming</a></li></ul></section><hr><section id=_dD><h2 id=contributors><a href=#contributors>Contributors</a></h2><p>Helpful? You can thank these awesome people! You can also edit this doc if you see any issues or want to improve it.</p><script>(e=>(self[e]||(self[e]=(l,f=e+l,s=f.length,a={},d=[],t=document,n=t.createTreeWalker(t,129))=>t=self[e][l]={i:f,d:t,l:a,v:d,x(){},w(e,l,r){for(;e=n.nextNode();)t.x(l=(l=e.data)&&!l.indexOf(f)&&(a[r=l.slice(s+1)]=e,l[s]),r,e),l>"#"&&d.push(e)}}),self[e]))("M")("_");M._.r=[_=>(_.g=[{params:{},url:new URL("http://localhost/docs/explanation/serializable-state")},4,{e:!1},_.h={b:8,e:10,ah:!1,ai:!1,a:_.a={d:"concise-mode"},d:_.b={d:"ts-mode"},ae:_.c={Fd:0,k:_.d={"aria-label":"Toggle Concise mode",checked:!1}},af:_.e={Fd:0,k:_.f={"aria-label":"Toggle TS mode",checked:!1}}},_.a,1,_.b,59,_.c,{f:{},h:576,i:512},1,_.e,{f:{},h:576,i:512},15,{f:"unserializable-data"},{f:"further-reading"}],_.a.U=_._.e0(_.a),_.a.T=_._.p2(_.h),_.b.U=_._.e0(_.b),_.b.T=_._.p3(_.h),_.c.Ed=_.d.checkedChange=_._.p0(_.h),_.e.Ed=_.f.checkedChange=_._.p1(_.h),_.g),"h0 4 o0 5 o1 5 e1 7 9 c0 70 r0 69 c0 73 r0 72 p34 6 p35 6 p36 6"];M._.w()</script><ul><li><a href=https://github.com/LuLaValva><img src=https://avatars.githubusercontent.com/u/26027232?v=4 alt>LuLaValva</a></li><li><a href=https://github.com/DylanPiercey><img src=https://avatars.githubusercontent.com/u/4985201?v=4 alt>DylanPiercey</a></li><li><a href=https://github.com/marko-js/website-next/blob/main/docs/explanation/serializable-state.md><div><svg viewBox="0 0 448 512"><path d="M256 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 160-160 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l160 0 0 160c0 17.7 14.3 32 32 32s32-14.3 32-32l0-160 160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-160 0 0-160z"></path></svg><!--M_*96 a--></div>You?</a></li></ul></section></article><div class=_dj id=page-menu><nav aria-labelledby=sM_1 class=_dk id=_dB><ul><li><strong id=sM_1>On this Page</strong></li><li><a href=#unserializable-data>Unserializable Data</a><!--M_*89 a--></li><li><a href=#further-reading>Further Reading</a><!--M_*90 a--></li></ul></nav></div></main></div><footer id=_a><a href="https://openjsf.org/" class=_b><img src=/assets/openjsf-u4IcyPV8.svg alt> <span><span class=_e>OpenJS&nbsp;</span><span class=_f>Foundation</span></span></a><div class=_g></div><a href=https://github.com/marko-js/marko/blob/main/LICENSE class=_d><img src=/assets/osi-BEF6Mbrt.svg alt> MIT&nbsp;License</a><div class=_g></div><a href=https://github.com/eBay class=_c><img src=/assets/ebay-CSr9mcj_.svg alt=eBay> open&nbsp;source</a></footer><script>M._.r.push(_=>(_.i=[5,{f:{},h:448,i:512}]),"c0 96 k0 89 90");M._.w()</script></body></html>